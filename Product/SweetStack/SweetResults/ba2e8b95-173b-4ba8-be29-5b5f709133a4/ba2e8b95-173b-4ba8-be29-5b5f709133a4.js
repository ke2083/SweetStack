var webPage = require('webpage');var page = webPage.create();console.log("Setting size to 'tablet'...");page.viewportSize = { width: 1024, height: 1280 };page.open('http://uat1.travel.saga.co.uk',function(){setTimeout(function(){setTimeout(function(){console.log('Taking screenshot...');page.render('1.png');page.evaluate(function(){function eventFire(el, etype){  if (el.fireEvent) {    el.fireEvent('on' + etype);  } else {    var evObj = document.createEvent('Events');    evObj.initEvent(etype, true, false);    el.dispatchEvent(evObj);  }};eventFire($('#destinationInputControl')[0], 'click');});setTimeout(function(){setTimeout(function(){console.log('Taking screenshot...');page.render('2.png');page.evaluate(function(){function eventFire(el, etype){  if (el.fireEvent) {    el.fireEvent('on' + etype);  } else {    var evObj = document.createEvent('Events');    evObj.initEvent(etype, true, false);    el.dispatchEvent(evObj);  }};$('#destinationSearchTextBox').val('Spain');eventFire($('#destinationSearchTextBox')[0], 'keydown');});setTimeout(function(){setTimeout(function(){console.log("Testing whether 'Spain' is in markup...");var found = page.evaluate(function(){return $('body').text().search('Spain') > -1;});if (found === true) console.log('PASS');else console.log('FAIL');console.log("Testing whether 'Port of Spain' is in markup...");var found = page.evaluate(function(){return $('body').text().search('Port of Spain') > -1;});if (found === true) console.log('PASS');else console.log('FAIL');console.log("Testing whether 'Split' is in markup...");var found = page.evaluate(function(){return $('body').text().search('Split') > -1;});if (found === true) console.log('PASS');else console.log('FAIL');console.log('Taking screenshot...');page.render('3.png');page.evaluate(function(){function eventFire(el, etype){  if (el.fireEvent) {    el.fireEvent('on' + etype);  } else {    var evObj = document.createEvent('Events');    evObj.initEvent(etype, true, false);    el.dispatchEvent(evObj);  }};eventFire($('a.searchOption')[0], 'click');});setTimeout(function(){setTimeout(function(){console.log('Taking screenshot...');page.render('3.png');page.evaluate(function(){function eventFire(el, etype){  if (el.fireEvent) {    el.fireEvent('on' + etype);  } else {    var evObj = document.createEvent('Events');    evObj.initEvent(etype, true, false);    el.dispatchEvent(evObj);  }};eventFire($('#runSearchButton')[0], 'click');});setTimeout(function(){setTimeout(function(){console.log('Taking screenshot...');page.render('4.png');console.log("Testing whether 'holidays found' is in markup...");var found = page.evaluate(function(){return $('body').text().search('holidays found') > -1;});if (found === true) console.log('PASS');else console.log('FAIL');console.log("Testing whether 'Hotel Avenida' is in markup...");var found = page.evaluate(function(){return $('body').text().search('Hotel Avenida') > -1;});if (found === true) console.log('PASS');else console.log('FAIL');console.log("Testing whether 'per person' is in markup...");var found = page.evaluate(function(){return $('body').text().search('per person') > -1;});if (found === true) console.log('PASS');else console.log('FAIL');console.log("Testing whether 'Holiday details' is in markup...");var found = page.evaluate(function(){return $('body').text().search('Holiday details') > -1;});if (found === true) console.log('PASS');else console.log('FAIL');phantom.exit();},10000);},1);},1000);},1);},3000);},1);},1000);},1);},5000);},1);});
