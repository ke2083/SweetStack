var webPage = require('webpage');var page = webPage.create();console.log("Setting size to 'smartphone'...");page.viewportSize = { width: 320, height: 480 };page.open('http://uat1.travel.saga.co.uk',function(){setTimeout(function(){setTimeout(function(){console.log('Taking screenshot...');page.render('1.png');page.evaluate(function(){function eventFire(el, etype){  if (el.fireEvent) {    el.fireEvent('on' + etype);  } else {    var evObj = document.createEvent('Events');    evObj.initEvent(etype, true, false);    el.dispatchEvent(evObj);  }};eventFire($('#destinationInputControl')[0], 'click');});setTimeout(function(){setTimeout(function(){console.log('Taking screenshot...');page.render('2.png');page.evaluate(function(){$('#destinationSearchTextBox').val('Spain');});setTimeout(function(){setTimeout(function(){console.log("Testing whether 'Spain' is in markup...");var found = page.evaluate(function(){return $('body').text().search('Spain') > -1;});if (found === true) console.log('PASS');else console.log('FAIL');console.log("Testing whether 'Port of Span' is in markup...");var found = page.evaluate(function(){return $('body').text().search('Port of Span') > -1;});if (found === true) console.log('PASS');else console.log('FAIL');console.log("Testing whether 'Split' is in markup...");var found = page.evaluate(function(){return $('body').text().search('Split') > -1;});if (found === true) console.log('PASS');else console.log('FAIL');console.log('Taking screenshot...');page.render('3.png');phantom.exit();},3000);},1);},1000);},1);},5000);},1);});
